<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# website: http://ogp.me/ns/website#">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<meta name="description" content="">
	<meta property="og:title" content="Stupid Solr tricks: Introduction (SST #0)">
	<link rel="icon" href="http://robotlibrarian.billdueber.com/" />
	
	
		<title>Robot Librarian | Stupid Solr tricks: Introduction (SST #0)</title>
		<meta property="og:type" content="article">
		<meta property="article:published_time" content= 2012-02-29 >
	
	<meta property="og:description" content="">
	<meta property="og:url" content="http://robotlibrarian.billdueber.com/2012/02/Stupid-Solr-tricks-Introduction-SST-">
	<meta property="og:site_name" content="Robot Librarian">
	
		<meta property="og:tags" content="solr">
	
		<meta property="og:tags" content="Stupid Solr Tricks">
	
	<meta name="generator" content="Hugo 0.19" />
   
	
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">

	
	<link rel="stylesheet" href="http://robotlibrarian.billdueber.comcss/style.css">
	<link href="" rel="alternate" type="application/rss+xml" title="Robot Librarian" />
</head>
<nav class="navbar navbar-default navbar-fixed-top visible-xs">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
				<a class="navbar-brand" href="http://robotlibrarian.billdueber.com">Robot Librarian</a>
			
		</div>
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				
				
			</ul>
		</div>
	</div>
</nav>
<div class="container-fluid">
	<div class="row">
		<div id="menu" class="hidden-xs col-sm-4 col-md-3">
	<div id="particles-js"></div>
	<div id="menu-content" class="vertical-align">
		
			<h1 class="text-center"><a href="http://robotlibrarian.billdueber.com">Robot Librarian</a></h1>
		
		
		
		
		
		<div id="social" class="text-center">
			
				
			
			
			
			
				
						
		</div>
		<div id="links" class="text-center">
			
			
		</div>
	</div>
</div>


		<div id="content" class="col-xs-12 col-sm-8 col-md-9">
			<div class="row">
				<div id="post" class="col-sm-offset-1 col-sm-10 col-md-10 col-lg-8">

<main>
	<header>
		<div class="panel-header">
			<h1>Stupid Solr tricks: Introduction (SST #0)
				
			</h1>
			<div class="panel-footer">
				
					<small class="text-muted">
						
						
							<font size="4"><a href="http://robotlibrarian.billdueber.comtags/solr"><span class="label label-success">solr</span></a></font>
						
							<font size="4"><a href="http://robotlibrarian.billdueber.comtags/Stupid-Solr-Tricks"><span class="label label-success">Stupid Solr Tricks</span></a></font>
						
					</small>
				
			</div>
			
		</div>
	</header>
	<br>
	<HR align=center>
	<article>
		

<p><strong>Completed parts of the series:</strong></p>

<ol>
<li><a href="http://robotlibrarian.billdueber.com/solr-field-type-for-numericish-ids/">A Solr Field Type for numeric(ish) IDs</a></li>
<li><a href="http://robotlibrarian.billdueber.com/using-localparams-in-solr-sst-2/">Using localparams in Solr (or, how to boost records that contain all terms)</a></li>
<li><a href="http://robotlibrarian.billdueber.com/requiringpreferring-searches-that-dont-span-multiple-values-sst-3/">Requiring/Preferring searches that don&rsquo;t span multiple values</a></li>
<li><a href="http://robotlibrarian.billdueber.com/boosting-on-exactish-anchored-phrase-matching-in-solr-sst-4/">Boosting on Exactish (anchored) phrase matching</a></li>
</ol>

<p>Those of you who read this blog regularly (Hi Mom!) know that while we do a lot of stuff at the <a href="http://lib.umich.edu">University of Michigan Library</a>, our bread-and-butter these days are projects that center around <a href="http://lucene.apache.org/solr/">Solr</a>.</p>

<p>Right now, my production Solr is running an ancient nightly of version 1.4 (i.e., before 1.4 was even officially released), and reflects how much I didn&rsquo;t know when we first started down this path. My primary responsibility is for <a href="http://mirlyn.lib.umich.edu">Mirlyn</a>, our catalog, but there&rsquo;s plenty of smart people doing smart things around here, and I&rsquo;d like to be one of them.</p>

<p>Solr has since advanced to 3.x (with version 4 on the horizon), and during that time I&rsquo;ve learned a lot more about Solr and how to push it around. More importantly, I&rsquo;ve learned a <em>lot</em> more about our data, the vagaries in the MARC/AACR2 that I process and how awful so much of it really is.</p>

<p>So&hellip;starting today I&rsquo;m going to be doing some on-the-blog experiments with a new version of Solr, reflecting some of the problems I&rsquo;ve run into and ways I think we can get more out of Solr.</p>

<h3 id="premise-1-put-all-the-logic-you-possible-can-into-solr">Premise 1: put all the logic you possible can into Solr</h3>

<p>Much of what I&rsquo;ll be doing is looking at new field type definitions that are appropriate (in my mind, anyway) for library data. Some of this stuff (e.g., normalizing ISBNs) would be a <em>lot</em> easier to do in your indexing code.</p>

<p>But then you&rsquo;d have to do it again in your application to munge whatever is entered in the search box. And maybe it won&rsquo;t be the same every time. Or maybe you don&rsquo;t want to write a freakin&rsquo; parser to try to find anything that might look like an ISBN and mess with it.</p>

<p>I take it as gospel that you should put all your logic into the solr field analysis chain, so the exact same thing is happening on index and on query. That way, even if it&rsquo;s <em>wrong</em>, at least it&rsquo;ll be wrong in the exact same way and your users will find the stuff they&rsquo;re looking for.</p>

<h3 id="premise-2-doing-it-crappily-is-better-than-not-doing-it-at-all">Premise 2: Doing it crappily is better than not doing it at all.</h3>

<p>Look, the <em>right</em> way to do much of this stuff is by hacking on Solr itself, building custom field analyzers or filters or tokenizers that mess with the token chain and&hellip;</p>

<p>Wait. I already lost myself, and probably you, too. At some point, I&rsquo;m going to do an actual sample custom filter for the new Solr codebase (the stuff I did once before is out-of-date); the example will be LCCN normalization and you&rsquo;ll be able to follow along with me on this blog.</p>

<p>But in the meantime, we can do a lot of fairly ambitious stuff just by using and abusing the out-of-the-box stuff: pattern replacement filters, the existing tokenizers, etc. It might be ugly, and not very fast, but if I start getting the 200 hits a second that mean this is a bottleneck for me, I&rsquo;ll be happy to deal with it then.</p>

<h3 id="premise-3-it-s-always-better-to-put-something-out-there-so-smart-people-can-tell-you-how-to-do-it-right">Premise 3: It&rsquo;s always better to put <em>something</em> out there so smart people can tell you how to do it <em>right</em></h3>

<p>One of the disappointments in my life right now is that there isn&rsquo;t more formal and informal discussion about what people are doing/trying. I&rsquo;m sure it&rsquo;s out there, but some of it is buried in a sea of application-level crap, and much of it is ignored by the people that really understand the data.</p>

<p>With luck, I&rsquo;ll get comments from folks who really know their stuff and can tell me, in excruciating detail, exactly how I <em>don&rsquo;t</em>. Please: correct me. I might not be the brightest guy in the room, but I know enough to try to outsource my thinking.</p>

<h3 id="follow-along-at-home">Follow along at home!</h3>

<h4 id="option-1-build-your-own-current-trunk-solr">Option 1: Build your own current-trunk Solr</h4>

<p>If you want to follow along at home, you&rsquo;ll need a copy of the current source (not the 3.5 stable, since I use things like the ICUTokenizer coming in 3.6 / 4.0), which you can find and build from the Solr site.</p>

<h4 id="option-2-just-use-what-i-m-using">Option 2: Just use what I&rsquo;m using</h4>

<p>Alternately, if you&rsquo;re lazy (and who isn&rsquo;t??), I&rsquo;ve provided a <a href="https://billdueber@github.com/billdueber/solr_stupid_tricks">github repo</a> of the standard solr &ldquo;example&rdquo; directory you can nab and run on your own java-equipped machine.</p>

<p><strong>Warning: the git repo is currently 60MB or so</strong>.</p>

<pre><code class="language-bash">  git clone https://billdueber@github.com/billdueber/solr_stupid_tricks.git
  cd solr_stupid_tricks
  java -jar start.jar
</code></pre>

<p>&hellip;and then head to your local <a href="http://localhost:8983/solr/admin/">Solr Admin page</a> page on port 8983 to check things out. We&rsquo;ll be spending most of our time in <a href="http://localhost:8983/solr/admin/analysis.jsp">the analysis tab</a>.</p>

<p>I&rsquo;ll get the first post in the series up later today, and then every few days as I think of more things to talk about. I hope you&rsquo;ll join me!</p>

	</article>
	<br>
	
</main>
	


						<br>
						<section id="footer">
							<div class="text-center center-block">
								<ul class="copyright">
									<li>&copy; 2017 <a target="_blank" href="http://robotlibrarian.billdueber.com"></a> | Powered by <a target="_blank" href="https://gohugo.io/">Gohugo</a> | Theme <a target="_blank" href="https://git.pofilo.fr/pofilo/hugo-fatboy">Fatboy</a></li>
								</ul>
							</div>
						</section>
					</div>
				</div>
			</div>
		</div>
	</div>
  
  
	
  
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>

	

	

	

	

	
	</body>
</html>





